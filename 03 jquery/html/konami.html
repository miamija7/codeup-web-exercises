<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Konami Code</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'VT323', monospace;
            background-image: url("../img/mario-bg.png");
            background-repeat: no-repeat;
            background-size: cover;
            color: white;
            font-size: 1.5em;
        }

        .header {
            display: flex;
            justify-content: space-around;
        }

        p {
            color: white;
            opacity: 20%;
            text-align: center;
            margin: 0;
            font-size: 0.75em
        }
    </style>
</head>
<body>
<div class="header">
    <h1>MARIO<br><span class="points">000000</span></h1>
    <h1>LIVES x <span class="lives"></span></h1>
    <h1><img style="width: 0.6em" src="../img/coin.png" alt="coin"> x 05</h1>
    <h1 style="text-align: center">WORLD<br>1-1</h1>
    <h1 style="text-align: right">TIME<br><span class="time"></span></h1>
</div>

<p>Konami Code: ↑ ↑ ↓ ↓ ← → ← → b a [enter]</p>
<script src="../js/jquery.js"></script>
<script>
    "use strict";

    /////////////////
    // KONAMI CODE //
    /////////////////
    let keyBuffer = "";
    const bufferLimit = 22;
    const konamiCode = "3838404037393739666513";

    $(document).keyup(function (event) {
        // store event keyCodes
        keyBuffer = (keyBuffer + ((event.keyCode).toString()));

        // trim buffer
        if (keyBuffer.length > 22) {
            keyBuffer = keyBuffer.substring(keyBuffer.length - bufferLimit);
        }

        // identify konami code
        if (keyBuffer === konamiCode) {
            alert("+ 30 LIVES!");
        }
    });

    /////////////////
    // LIVE HEADER //
    /////////////////
    const pointsDisplay = document.querySelector(".points");
    const livesDisplay = document.querySelector(".lives");
    const timeDisplay = document.querySelector(".time");

    pointsDisplay.textContent = "000000";
    livesDisplay.textContent = "3";
    timeDisplay.textContent = "0";

    let timer = setInterval(function () {
        timeDisplay.textContent = (parseInt(timeDisplay.textContent) + 1).toString();
    }, 100)

    $(document).keyup(function (event) {
        // header points handler
        let pointsEarned = parseInt(event.keyCode);
        pointsDisplay.textContent = ("0000" + (parseInt(pointsDisplay.textContent) + pointsEarned).toString());
        pointsDisplay.textContent = pointsDisplay.textContent.substring(pointsDisplay.textContent.length - 6);

        if (keyBuffer === konamiCode) {
            // header live handler
            livesDisplay.textContent = (parseInt(livesDisplay.textContent) + 30).toString();
            // header time handler
            // clearInterval(timer);
        }
    })

    $(document).click(function () {
        alert("GAME PAUSED\n\nhint: earn points with the key events!\n\nclick ok to resume");
    })
</script>
</body>
</html>